@tailwind base;
@tailwind components;
@tailwind utilities;

/* =========================================
   XOZY-EP STYLESHEET v5.1 (FIXED)
   ========================================= */

/* --- 1. VARIABLES & THEMES --- */
:root {
  --bg: linear-gradient(135deg, #d8d4c9 0%, #b1b1b1 33%, #c9b98d 66%, #a1a1a1 100%);
  --accent: #ff3e00;
  --ghost: rgba(255, 62, 0, 0.25);
  --magic: #8a2be2;
  --text: #1a1a1a;
  --lcd-bg: #080a08;
  --lcd-text: #39ff14;
  --border: #8e8e8e;
  --panel-bg: rgba(255, 255, 255, 0.45);
  --shadow: rgba(0,0,0,0.4);
  --fader-track: #ccc;
  --key-white: #f0f0f0;
  --key-black: #2a2a2a;
}

body.theme-40 { --bg: #f4f1e6; --accent: #006633; --ghost: rgba(0, 102, 51, 0.3); --text: #1a1a1a; --lcd-bg: #050a05; --lcd-text: #008f11; --border: #c5c2b7; --panel-bg: #ffffff; }
body.theme-133 { --bg: #bcbcbc; --accent: #ff3e00; --ghost: rgba(255, 62, 0, 0.3); --text: #000000; --lcd-bg: #121212; --lcd-text: #ff4500; --border: #888888; --panel-bg: #e0e0e0; }
body.theme-1320 { --bg: #dccb96; --accent: #9b111e; --ghost: rgba(155, 17, 30, 0.3); --text: #3d2b1f; --lcd-bg: #2e1a0d; --lcd-text: #f3e5ab; --border: #a6894c; --panel-bg: #e6d9ad; }

body.dark-mode {
  --bg: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
  --text: #e0e0e0; --border: #444; --panel-bg: rgba(30,30,30,0.9);
  --fader-track: #444; --magic: #bd7bf0; --key-white: #aaa; --key-black: #000;
}

/* --- 2. GLOBAL LAYOUT --- */
body {
  background: var(--bg); background-attachment: fixed; color: var(--text);
  font-family: 'IBM Plex Mono', monospace; display: flex; flex-direction: column;
  align-items: center; justify-content: center; min-height: 100vh; margin: 0;
  transition: all 0.4s ease;
}

.chassis {
  background: var(--panel-bg); border: 2px solid var(--border); border-radius: 12px;
  padding: 25px; width: 95%; max-width: 1100px;
  box-shadow: 20px 20px 60px rgba(0,0,0,0.3); backdrop-filter: blur(10px);
  margin: 20px 0; transition: max-width 0.4s ease;
}
.chassis.skinny-mode { max-width: 480px; }

/* --- 3. HEADER & LCD --- */
.header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
h1 { margin: 0; font-size: 1.2rem; letter-spacing: 4px; font-weight: 900; }

.lcd-display {
  background: var(--lcd-bg); color: var(--lcd-text); padding: 12px;
  border-radius: 4px; font-size: 0.75rem; font-weight: normal; border: 4px solid #222;
  width: 100%; height: 60px; box-shadow: inset 0 0 20px #000; text-shadow: 0 0 3px var(--lcd-text);
  overflow-y: auto; font-family: 'Courier New', Courier, monospace;
  display: flex; flex-direction: column-reverse; box-sizing: border-box; margin-bottom: 20px;
}
.log-entry { border-bottom: 1px solid rgba(255,255,255,0.1); padding: 2px 0; }

/* --- 4. NAVIGATION TABS --- */
.tab-row {
  display: flex;
  gap: 5px;
  margin-bottom: 15px;
  border-bottom: 2px solid var(--border);
}
.btn-tab {
  background: transparent;
  border: none;
  color: var(--text);
  font-family: inherit;
  font-weight: 900;
  cursor: pointer;
  padding: 8px 16px;
  font-size: 0.75rem;
  opacity: 0.4;
  text-transform: uppercase;
  transition: 0.2s;
}
.btn-tab.active {
  opacity: 1;
  color: var(--accent);
  border-bottom: 3px solid var(--accent);
}

/* --- 5. MAIN DECK LAYOUT --- */
.main-deck { display: grid; grid-template-columns: 1fr 1.4fr; gap: 40px; }
.chassis.skinny-mode .main-deck { grid-template-columns: 1fr; }

/* --- 6. CONTROLS (Left) --- */
.control-group { background: rgba(0,0,0,0.05); padding: 15px; border-radius: 8px; border: 1px solid var(--border); margin-bottom: 20px; }
.config-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; align-items: end; }
.split-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; align-items: end; }

label { font-size: 0.55rem; font-weight: 800; text-transform: uppercase; margin-bottom: 6px; display: block; letter-spacing: 1px; opacity: 0.8; }
select, input { width: 100%; padding: 8px; background: var(--bg); border: 1px solid var(--text); color: var(--text); font-family: inherit; border-radius: 2px; font-weight: bold; font-size: 0.75rem; box-sizing: border-box; }

.knob { -webkit-appearance: none; width: 100%; height: 4px; background: var(--text); outline: none; border-radius: 2px; margin-top: 5px; }
.knob::-webkit-slider-thumb { -webkit-appearance: none; width: 12px; height: 12px; background: var(--accent); border-radius: 50%; cursor: pointer; border: 2px solid white; box-shadow: 0 1px 3px rgba(0,0,0,0.5); }

/* --- 7. PERFORMANCE PADS --- */
.performance-container { display: grid; grid-template-columns: 45px 1fr; gap: 20px; }
.group-strip { display: flex; flex-direction: column; gap: 6px; }
.group-btn { flex: 1; background: rgba(0,0,0,0.1); border: 2px solid var(--text); border-radius: 4px; color: var(--text); font-weight: 900; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 0.9rem; }
.group-btn.active { background: var(--accent); color: white; border-color: var(--accent); }
.ep-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; }
.pad-btn { background: rgba(0,0,0,0.05); border: 2px solid var(--border); aspect-ratio: 4/3; border-radius: 6px; cursor: pointer; position: relative; }
.pad-btn.active-pad { border-color: var(--accent); background: var(--accent) !important; color: white; }
.pad-btn.hit { filter: brightness(1.5); }
.legend-tag { position: absolute; top: 4px; right: 6px; font-weight: 900; font-size: 0.65rem; opacity: 0.5; }

/* --- 8. EDITOR PANELS (Right) --- */
.editor-panel { background: rgba(0,0,0,0.03); border: 2px solid var(--border); padding: 20px; border-radius: 8px; flex-grow: 1; }
.editor-header { border-bottom: 1px solid var(--border); padding-bottom: 10px; margin-bottom: 15px; font-weight: 900; letter-spacing: 1px; }

/* --- 9. PIANO KEYBOARDS (CAPSULE STYLE RESTORED) --- */
.kb-octave { position: relative; width: 100%; border-radius: 8px; background: transparent; }
.kb-whites { position: absolute; inset: 0; display: flex; gap: 4px; }
.kb-white {
  background: var(--key-white); border: 2px solid var(--border); flex: 1; 
  cursor: pointer; transition: 0.1s; border-radius: 999px; /* CAPSULE SHAPE */
}
.kb-white:active { background: #ddd; }
.kb-blacks { position: absolute; inset: 0; pointer-events: none; }
.kb-black { 
  position: absolute; background: #111; cursor: pointer; pointer-events: auto;
  border-radius: 999px; /* CAPSULE SHAPE */
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 2px 5px rgba(0,0,0,0.5);
}

/* Specific Sizes for Chord Mode (Fat) */
#tab-chord .kb-octave { height: 170px; }
#tab-chord .kb-black { width: 10%; height: 90px; top: 5px; }

/* Specific Sizes for Synth Mode (Skinny but Capsule) */
#tab-synth .synth-piano-container { width: 100%; overflow-x: auto; padding-bottom: 10px; }
#tab-synth .kb-octave { width: 1000px; height: 160px; } 
#tab-synth .kb-white { margin: 0 2px; } /* Tighter gap */
#tab-synth .kb-black { width: 3.2%; height: 90px; z-index: 2; top: 5px; }

/* --- 10. SEQUENCER GRID --- */
.step-container { display: grid; grid-template-columns: repeat(8, 1fr); gap: 2px; width: 100%; margin-top: 10px; min-height: 200px; }
.step-box { aspect-ratio: 1/1; border: 2px solid var(--text); display: flex; align-items: center; justify-content: center; font-size: 0.75rem; cursor: pointer; font-weight: 900; border-radius: 3px; opacity: 0.4; }
.step-box.on-x { background: var(--accent); color: white; border-color: var(--accent); opacity: 1; }
.step-box.on-y { background: #555; color: white; border-color: #555; opacity: 1; }
.step-box.on-z { color: var(--accent); border-color: var(--accent); border-style: dashed; opacity: 1; }

/* --- 11. BUTTONS --- */
.btn-main { background: var(--text); color: var(--bg); border: none; padding: 18px; font-weight: 900; cursor: pointer; border-radius: 4px; text-transform: uppercase; width: 100%; letter-spacing: 1px; }
.btn-main.primary { background: var(--accent); color: white; }
.btn-small { background: #555; color: white; border: none; padding: 10px; font-size: 0.65rem; cursor: pointer; border-radius: 3px; font-weight: bold; width: 100%; }
.btn-toggle-on { background: var(--lcd-text) !important; color: black !important; }
.action-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }